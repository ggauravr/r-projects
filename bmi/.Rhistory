# results: 481, 150 and 67 respectively
lapply(2:4, function(x) nrow(topTable(eBayesFit, coef=1, number=Inf, lfc=x)) )
# get the probeset_ids and the relevant statistics
# map the probeset_ids to their corresponding gene symbols, using the annotation db
# combine/map probeset_ids and their statistics to gene symbols
# write the results into a file
gene.list <- topTable(eBayesFit, coef=1, number=Inf, sort.by='logFC')
gene.symbols <- getSYMBOL(row.names(gene.list), "hgu133plus2.db")
gene.results <- cbind(gene.list, gene.symbols)
write.table(gene.results, file="gene_details.txt", sep="\t")
# find the top 10 up-regulated and top 10 down-regulated genes
# write them to a file for convenience
gene.up <- head(gene.results[gene.results$logFC > 0, ], n=10)
gene.down <- head(gene.results[gene.results$logFC < 0, ], n=10)
write.table(gene.up, file="genes_up_regulated.txt", sep="\t")
write.table(gene.down, file="genes_down_regulated.txt", sep="\t")
temp <- paste(row.names(gene.results), gene.symbols)
head(temp)
temp <- paste("(", row.names(gene.results), ", ", gene.symbols, ")", sep="")
head(temp)
labels <- paste("(", row.names(gene.results), ", ", gene.symbols, ")", sep="")
labels
probe.labels <- paste("(", row.names(gene.results), ", ", gene.symbols, ")", sep="")
probe.labels[probe.not.positions] <- NA
gene.symbols[is.na(gene.symbols)] <- "XXXXX"
probe.matches <- gene.symbols == "EGFR" | gene.symbols == "SOX2" | gene.symbols == "TP53"
probe.not.positions <- which(!probe.matches)
probe.labels <- paste("(", row.names(gene.results), ", ", gene.symbols, ")", sep="")
# probe.labels <- gene.symbols
probe.labels[probe.not.positions] <- NA
probe.labels
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) )) +
geom_point(aes(shape=probe.matches, color=probe.matches)) +
geom_text(size=3) +
xlab("log2 fold-change") +
ylab("-log10 p-value")
library(ggplot2)
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) )) +
geom_point(aes(shape=probe.matches, color=probe.matches)) +
geom_text(size=3) +
xlab("log2 fold-change") +
ylab("-log10 p-value")
probe.labels[!is.na(probe.labels)]
probe.labels <- paste("(", row.names(gene.results), ", ", gene.symbols, ")", sep="")
probe.labels[probe.not.positions] <- NA
write.table(probe.labels[!is.na(probe.labels)], file="genes_probes_map.txt")
write.table(gene.up, file="gene_up.txt", sep="\t")
write.table(gene.down, file="gene_down.txt", sep="\t")
write.table(probe.labels[!is.na(probe.labels)], file="gene_probe_map.txt")
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) )) +
geom_point(aes(shape=probe.matches, color=probe.matches, size=probe.matches)) +
geom_text(size=3) +
xlab("log2 fold-change") +
ylab("-log10 p-value")
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) )) +
geom_point(aes(shape=probe.matches, color=probe.matches)) +
geom_text(size=3) +
xlab("log2 fold-change") +
ylab("-log10 p-value")
gene.symbols[is.na(gene.symbols)] <- "????"
probe.matches <- gene.symbols == "EGFR" | gene.symbols == "SOX2" | gene.symbols == "TP53"
probe.not.positions <- which(!probe.matches)
probe.labels <- paste("(", row.names(gene.results), ", ", gene.symbols, ")", sep="")
probe.labels[probe.not.positions] <- NA
write.table(probe.labels[!is.na(probe.labels)], file="gene_probe_map.txt")
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) )) +
geom_point(aes(shape=probe.matches, color=probe.matches)) +
geom_text(size=3) +
xlab("log2 fold-change") +
ylab("-log10 p-value")
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) )) +
geom_point(aes(shape=probe.matches, color=probe.matches)) +
geom_text(size=3) +
xlab("Log2 Fold-Change") +
ylab("-Log10 P-Value")
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) )) +
geom_point(aes(shape=probe.matches, color=probe.matches)) +
geom_text(size=3) +
xlab("Log2 Fold-Change") +
ylab("-Log10 P-Value")
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) )) +
geom_point(aes(shape=probe.matches, color=probe.matches)) +
geom_text(size=3) +
xlab("Log2 Fold-Change") +
ylab("-Log10 P-Value") +
guides(fill=F)
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) )) +
geom_point(aes(shape=probe.matches, color=probe.matches)) +
geom_text(size=3) +
xlab("Log2 Fold-Change") +
ylab("-Log10 P-Value") +
guides(color=F)
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) )) +
geom_point(aes(shape=probe.matches, color=probe.matches)) +
geom_text(size=3) +
xlab("Log2 Fold-Change") +
ylab("-Log10 P-Value") +
guides(shape=F)
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) )) +
geom_point(aes(shape=probe.matches, color=probe.matches)) +
geom_text(size=3) +
xlab("Log2 Fold-Change") +
ylab("-Log10 P-Value") +
scale_fill_discrete(name="Experimental\nCondition",
breaks=c("ctrl", "trt1", "trt2"),
labels=c("Control", "Treatment 1", "Treatment 2"))
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) )) +
geom_point(aes(shape=probe.matches, color=probe.matches)) +
geom_text(size=3) +
xlab("Log2 Fold-Change") +
ylab("-Log10 P-Value") +
scale_color_discrete(name="Experimental\nCondition",
breaks=c("ctrl", "trt1"),
labels=c("Control", "Treatment 1"))
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) )) +
geom_point(aes(shape=probe.matches, color=probe.matches)) +
geom_text(size=3) +
xlab("Log2 Fold-Change") +
ylab("-Log10 P-Value") +
scale_color_discrete(name="Experimental\nCondition",
breaks=c("ctrl", "trt1"),
labels=c("Control", "Treatment 1")) +
scale_shape_discrete(name="Experimental\nCondition",
breaks=c("ctrl", "trt1"),
labels=c("Control", "Treatment 1"))
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) )) +
geom_point(aes(shape=probe.matches, color=probe.matches)) +
geom_text(size=3) +
xlab("Log2 Fold-Change") +
ylab("-Log10 P-Value") +
scale_color_discrete(name="Experimental\nCondition",
breaks=c("ctrl", "trt1"),
labels=c("Control", "Treatment 1")) +
scale_shape_discrete(name="Experimental\nCondition",
breaks=c("ctrl", "trt1"),
labels=c("Control", "Treatment 1"))
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) )) +
geom_point(aes(shape=probe.matches, color=probe.matches)) +
geom_text(size=3) +
xlab("Log2 Fold-Change") +
ylab("-Log10 P-Value") +
scale_shape_discrete(name="Experimental\nCondition",
breaks=c("ctrl", "trt1"),
labels=c("Control", "Treatment 1")) +
scale_color_discrete(name="Experimental\nCondition",
breaks=c("ctrl", "trt1"),
labels=c("Control", "Treatment 1"))
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) )) +
geom_point(aes(shape=probe.matches, color=probe.matches)) +
geom_text(size=3) +
xlab("Log2 Fold-Change") +
ylab("-Log10 P-Value") +
scale_shape_discrete(name="Experimental\nCondition",
breaks=c("ctrl", "trt1"),
labels=c("Control", "Treatment 1"))
a <- 1
a += a
plotObject <- ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) ))
plotObject <- plotObject + geom_point(aes(shape=probe.matches, color=probe.matches))
plotObject <- plotObject + geom_text(size=3) +
plotObject <- plotObject + xlab("Log2 Fold-Change") + ylab("-Log10 P-Value") +
plotObject <- plotObject + scale_shape_discrete(name="Experimental\nCondition", breaks=c("ctrl", "trt1"), labels=c("Control", "Treatment 1"))
plotObject <- ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) ))
plotObject <- plotObject + geom_point(aes(shape=probe.matches, color=probe.matches))
plotObject <- plotObject + geom_text(size=3) +
plotObject <- plotObject + xlab("Log2 Fold-Change") + ylab("-Log10 P-Value") +
plotObject <- plotObject + scale_shape_discrete(name="Experimental\nCondition", breaks=c("ctrl", "trt1"), labels=c("Control", "Treatment 1"))
plotObject <- ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) ))
plotObject <- plotObject + geom_point(aes(shape=probe.matches, color=probe.matches))
plotObject <- plotObject + geom_text(size=3) +
plotObject <- plotObject + xlab("Log2 Fold-Change") + ylab("-Log10 P-Value")
plotObject <- plotObject + scale_shape_discrete(name="Experimental\nCondition", breaks=c("ctrl", "trt1"), labels=c("Control", "Treatment 1"))
plotObject <- ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) ))
plotObject + geom_point(aes(shape=probe.matches, color=probe.matches))
plotObject + geom_text(size=3) +
plotObject + xlab("Log2 Fold-Change") + ylab("-Log10 P-Value")
plotObject + scale_shape_discrete(name="Experimental\nCondition", breaks=c("ctrl", "trt1"), labels=c("Control", "Treatment 1"))
plotObject <- ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) ))
plotObject + geom_point(aes(shape=probe.matches, color=probe.matches))
plotObject + geom_text(size=3)
plotObject + xlab("Log2 Fold-Change") + ylab("-Log10 P-Value")
plotObject + scale_shape_discrete(name="Experimental\nCondition", breaks=c("ctrl", "trt1"), labels=c("Control", "Treatment 1"))
plotObject <- ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) ))
plotObject
plotObject + geom_point(aes(shape=probe.matches, color=probe.matches))
plotObject + geom_text(size=3)
plotObject + xlab("Log2 Fold-Change") + ylab("-Log10 P-Value")
plotObject + scale_shape_discrete(name="Experimental\nCondition", breaks=c("ctrl", "trt1"), labels=c("Control", "Treatment 1"))
plotObject <- ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) ))
+ geom_point(aes(shape=probe.matches, color=probe.matches))
+ geom_text(size=3)
+ xlab("Log2 Fold-Change") + ylab("-Log10 P-Value")
plotObject <- ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) )) +
geom_point(aes(shape=probe.matches, color=probe.matches)) +
geom_text(size=3) +
xlab("Log2 Fold-Change") +
ylab("-Log10 P-Value") +
scale_shape_discrete(name="Experimental\nCondition", breaks=c("ctrl", "trt1"), labels=c("Control", "Treatment 1"))
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) )) +
geom_point(aes(shape=probe.matches, color=probe.matches)) +
geom_text(size=3) +
xlab("Log2 Fold-Change") +
ylab("-Log10 P-Value") +
scale_shape_discrete(name="Experimental\nCondition", breaks=c("ctrl", "trt1"), labels=c("Control", "Treatment 1"))
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) )) +
geom_point(aes(shape=probe.matches, color=probe.matches)) +
geom_text(size=3) +
xlab("Log2 Fold-Change") +
ylab("-Log10 P-Value") +
scale_shape_discrete(name="Experimental\nCondition", breaks=c("ctrl", "trt1"), labels=c("Control", "Treatment 1")) +
scale_color_discrete(name="Experimental\nCondition", breaks=c("ctrl", "trt1"), labels=c("Control", "Treatment 1"))
?theme
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) )) +
geom_point(aes(shape=probe.matches, color=probe.matches)) +
geom_text(size=3) +
xlab("Log2 Fold-Change") +
ylab("-Log10 P-Value") +
theme(legend.title = "Gene Type")
?element.text
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) )) +
geom_point(aes(shape=probe.matches, color=probe.matches)) +
geom_text(size=3) +
xlab("Log2 Fold-Change") +
ylab("-Log10 P-Value") +
# scale_shape_discrete(name="Experimental\nCondition", breaks=c("ctrl", "trt1"), labels=c("Control", "Treatment 1")) +
scale_color_discrete(name="Experimental\nCondition", breaks=c("ctrl", "trt1"), labels=c("Control", "Treatment 1"))
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) )) +
geom_point(aes(shape=probe.matches, color=probe.matches)) +
geom_text(size=3) +
xlab("Log2 Fold-Change") +
ylab("-Log10 P-Value") +
scale_shape_discrete(name="Experimental\nCondition", breaks=c("ctrl", "trt1"), labels=c("Control", "Treatment 1"))
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) )) +
geom_point(aes(shape=probe.matches, color=probe.matches)) +
geom_text(size=3) +
xlab("Log2 Fold-Change") +
ylab("-Log10 P-Value") +
scale_shape_manual(name="Experimental\nCondition", breaks=c("ctrl", "trt1"), labels=c("Control", "Treatment 1"))
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) )) +
geom_point(aes(shape=probe.matches, color=probe.matches)) +
geom_text(size=3) +
xlab("Log2 Fold-Change") +
ylab("-Log10 P-Value") +
scale_shape_discrete(name="Experimental\nCondition", breaks=c("ctrl", "trt1"), labels=c("Control", "Treatment 1"))
# scale_color_discrete(name="Experimental\nCondition", breaks=c("ctrl", "trt1"), labels=c("Control", "Treatment 1"))
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) )) +
geom_point(aes(shape=probe.matches, color=probe.matches)) +
geom_text(size=3) +
xlab("Log2 Fold-Change") +
ylab("-Log10 P-Value") +
guide_legend(title="ddfdf")
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) )) +
geom_point(aes(shape=probe.matches, color=probe.matches)) +
geom_text(size=3) +
xlab("Log2 Fold-Change") +
ylab("-Log10 P-Value") +
# scale_shape_discrete(name="Experimental\nCondition", breaks=c("ctrl", "trt1"), labels=c("Control", "Treatment 1"))
scale_color_discrete(name="Experimental\nCondition", breaks=c("ctrl", "trt1"), labels=c("Control", "Treatment 1"))
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) )) +
geom_point(aes(shape=probe.matches, color=probe.matches)) +
geom_text(size=3) +
xlab("Log2 Fold-Change") +
ylab("-Log10 P-Value") +
# scale_shape_discrete(name="Experimental\nCondition", breaks=c("ctrl", "trt1"), labels=c("Control", "Treatment 1"))
scale_colour_discrete(name="Experimental\nCondition", breaks=c("ctrl", "trt1"), labels=c("Control", "Treatment 1"))
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value) )) +
geom_point(aes(shape=probe.matches, color=probe.matches)) +
geom_text(size=3) +
xlab("Log2 Fold-Change") +
ylab("-Log10 P-Value") +
# scale_shape_discrete(name="Experimental\nCondition", breaks=c("ctrl", "trt1"), labels=c("Control", "Treatment 1"))
scale_colour_manual(values=c("green", "blue"), name="Experimental\nCondition", breaks=c("ctrl", "trt1"), labels=c("Control", "Treatment 1"))
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value),
shape=probe.matches,
color=probe.matches)) +
geom_point() +
geom_text(size=3) +
xlab("Log2 Fold-Change") +
ylab("-Log10 P-Value") +
scale_shape_discrete(name="Experimental\nCondition", breaks=c("ctrl", "trt1"), labels=c("Control", "Treatment 1")) +
scale_colour_discrete(name="Experimental\nCondition", breaks=c("ctrl", "trt1"), labels=c("Control", "Treatment 1"))
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value),
shape=probe.matches,
color=probe.matches)) +
geom_point() +
geom_text(size=3) +
xlab("Log2 Fold-Change") +
ylab("-Log10 P-Value") +
scale_shape_discrete(name="df", breaks=c("ctrl", "trt1"), labels=c("Control", "Treatment 1")) +
scale_colour_discrete(name="Df", breaks=c("ctrl", "trt1"), labels=c("Control", "Treatment 1"))
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value))) +
geom_point(aes(shape=probe.matches,
color=probe.matches)) +
geom_text(size=3) +
xlab("Log2 Fold-Change") +
ylab("-Log10 P-Value") +
scale_shape_discrete(name="df", breaks=c("ctrl", "trt1"), labels=c("Control", "Treatment 1")) +
scale_colour_discrete(name="Df", breaks=c("ctrl", "trt1"), labels=c("Control", "Treatment 1"))
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value))) +
geom_point(aes(shape=probe.matches,
colour=probe.matches)) +
geom_text(size=3) +
xlab("Log2 Fold-Change") +
ylab("-Log10 P-Value") +
scale_shape_discrete(name="df", breaks=c("ctrl", "trt1"), labels=c("Control", "Treatment 1")) +
scale_colour_discrete(name="Df", breaks=c("ctrl", "trt1"), labels=c("Control", "Treatment 1"))
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value))) +
geom_point(aes(shape=probe.matches,
colour=probe.matches)) +
geom_text(size=3) +
xlab("Log2 Fold-Change") +
ylab("-Log10 P-Value") +
scale_shape_discrete(name="df", breaks=c(TRUE, FALSE), labels=c("Control", "Treatment 1")) +
scale_colour_discrete(name="Df", breaks=c(TRUE, FALSE), labels=c("Control", "Treatment 1"))
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value))) +
geom_point(aes(shape=probe.matches,
colour=probe.matches)) +
geom_text(size=3) +
xlab("Log2 Fold-Change") +
ylab("-Log10 P-Value") +
scale_shape_discrete(name="Shape", breaks=c(TRUE, FALSE), labels=c("EGFR, TP53, SOX2", "Other")) +
scale_colour_discrete(name="Color", breaks=c(TRUE, FALSE), labels=c("EGFR, TP53, SOX2", "Other"))
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value))) +
geom_point(aes(shape=probe.matches,
colour=probe.matches)) +
geom_text(size=3) +
xlab("Log2 Fold-Change") +
ylab("-Log10 P-Value") +
scale_shape_discrete(name="Shape", breaks=c(TRUE, FALSE), labels=c("EGFR, TP53, SOX2", "Other")) +
scale_colour_discrete(name="Color", breaks=c(TRUE, FALSE), labels=c("EGFR, TP53, SOX2", "Other")) +
ggtitle("sdsd")
ggplot(gene.list,
aes(
label=probe.labels,
x=gene.list$logFC,
y=-log10(gene.list$P.Value))) +
geom_point(aes(shape=probe.matches,
colour=probe.matches)) +
geom_text(size=3) +
xlab("Log2 Fold-Change") +
ylab("-Log10 P-Value") +
scale_shape_discrete(name="Shape", breaks=c(TRUE, FALSE), labels=c("EGFR, TP53, SOX2", "Other")) +
scale_colour_discrete(name="Color", breaks=c(TRUE, FALSE), labels=c("EGFR, TP53, SOX2", "Other")) +
ggtitle("Volcano Plot(Fold-Change of Genes vs P-Value)")
